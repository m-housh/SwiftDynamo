<!DOCTYPE html>
<html lang="en">
  <head>
    <title>SwiftDynamo  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="SwiftDynamo  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          SwiftDynamo
        </a>
         (67% documented)
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">SwiftDynamo Reference</a>
      <img class="carat" src="img/carat.png" />
      SwiftDynamo  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CompositeSortKey.html">CompositeSortKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DynamoQueryBuilder.html">DynamoQueryBuilder</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Field.html">Field</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ID.html">ID</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ID/Generator.html">– Generator</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/ID/IDType.html">– IDType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/Parent.html">Parent</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/SortKey.html">SortKey</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/DynamoModelError.html">DynamoModelError</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/DynamoDB.html">DynamoDB</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/Encodable.html">Encodable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Extensions/UUID.html">UUID</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:11SwiftDynamo2neoiyAA0B16ModelValueFilterVyxGs7KeyPathCyxq_G_0E0Qy_tAA0bD0RzAA18FieldRepresentibleR_r0_lF">!=(_:_:)</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Functions.html#/s:11SwiftDynamo2eeoiyAA0B16ModelValueFilterVyxGs7KeyPathCyxq_G_0E0Qy_tAA0bD0RzAA18FieldRepresentibleR_r0_lF">==(_:_:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AnyDynamoDatabaseKey.html">AnyDynamoDatabaseKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AnyField.html">AnyField</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AnyModel.html">AnyModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AnyProperty.html">AnyProperty</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols.html#/s:11SwiftDynamo10AnySortKeyP">AnySortKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AttributeConvertible.html">AttributeConvertible</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AttributeDecodable.html">AttributeDecodable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/AttributeEncodable.html">AttributeEncodable</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/DynamoModel.html">DynamoModel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/FieldRepresentible.html">FieldRepresentible</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Protocols/RandomGeneratable.html">RandomGeneratable</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DatabaseOutput.html">DatabaseOutput</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DatabaseOutput/Output.html">– Output</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs.html#/s:11SwiftDynamo0B16ModelValueFilterV">DynamoModelValueFilter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoQuery.html">DynamoQuery</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoQuery/Action.html">– Action</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoQuery/Value.html">– Value</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoQuery/Option.html">– Option</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoQuery/Filter.html">– Filter</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoSchema.html">DynamoSchema</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoSchema/SortKey.html">– SortKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/DynamoSchema/PartitionKey.html">– PartitionKey</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/PaginatedResponse.html">PaginatedResponse</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <h1 id='swiftdynamo' class='heading'>SwiftDynamo</h1>

<p>A vapor like interface to <code>DynamoDB</code>.</p>
<h2 id='the-basics' class='heading'>The Basics</h2>

<p>Use swift package manager to use in your project.  Check basic usage below as well as the api-gateway example that uses
the <a href="https://github.com/fabianfett/swift-lambda-runtime.git">LambdaRuntime</a> package.</p>
<h3 id='package-swift' class='heading'>Package.swift</h3>
<pre class="highlight swift"><code>
<span class="o">...</span>
<span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
    <span class="c1">// Dependencies declare other packages that this package depends on.</span>
    <span class="c1">// .package(url: /* package url */, from: "1.0.0"),</span>
    <span class="o">.</span><span class="nf">package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/m-housh/SwiftDynamo.git"</span><span class="p">,</span> <span class="nv">from</span><span class="p">:</span> <span class="s">"0.1.1"</span><span class="p">),</span>
<span class="p">],</span>
<span class="o">...</span>
</code></pre>
<h3 id='todomodel-swift' class='heading'>TodoModel.swift</h3>
<pre class="highlight swift"><code>
<span class="kd">import</span> <span class="kt">SwiftDynamo</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">TodoModel</span><span class="p">:</span> <span class="kt">DynamoModel</span> <span class="p">{</span>

    <span class="kd">static</span> <span class="k">var</span> <span class="nv">schema</span><span class="p">:</span> <span class="kt">DynamoSchema</span> <span class="o">=</span> <span class="s">"Todos"</span>

    <span class="kd">@ID(key: "TodoID")</span>
    <span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">?</span>

    <span class="kd">@Field(key: "Title")</span>
    <span class="k">var</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span>

    <span class="kd">@Field(key: "Completed")</span>
    <span class="k">var</span> <span class="nv">completed</span><span class="p">:</span> <span class="kt">Bool</span>

    <span class="kd">@Field(key: "Order")</span>
    <span class="k">var</span> <span class="nv">order</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span>

    <span class="nf">init</span><span class="p">()</span> <span class="p">{</span> <span class="p">}</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">completed</span><span class="p">:</span> <span class="kt">Bool</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span> <span class="nv">order</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span> <span class="o">=</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">id</span>
        <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">title</span>
        <span class="k">self</span><span class="o">.</span><span class="n">completed</span> <span class="o">=</span> <span class="n">completed</span>
        <span class="k">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">PatchTodo</span><span class="p">:</span> <span class="kt">Codable</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
    <span class="k">let</span> <span class="nv">order</span><span class="p">:</span> <span class="kt">Int</span><span class="p">?</span>
    <span class="k">let</span> <span class="nv">completed</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">?</span>

    <span class="kd">func</span> <span class="nf">patchQuery</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="k">inout</span> <span class="kt">DynamoQueryBuilder</span><span class="o">&lt;</span><span class="kt">TodoModel</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">title</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">title</span> <span class="p">{</span>
            <span class="n">query</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">title</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">title</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">order</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">order</span> <span class="p">{</span>
            <span class="n">query</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">order</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">order</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">completed</span> <span class="o">=</span> <span class="k">self</span><span class="o">.</span><span class="n">completed</span> <span class="p">{</span>
            <span class="n">query</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">completed</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="n">completed</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h3 id='todostore-swift' class='heading'>TodoStore.swift</h3>
<pre class="highlight swift"><code>
<span class="kd">import</span> <span class="kt">DynamoDB</span>

<span class="kd">struct</span> <span class="kt">TodoStore</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">dynamoDB</span><span class="p">:</span> <span class="kt">DynamoDB</span>

    <span class="nf">init</span><span class="p">(</span>
        <span class="nv">eventLoopGroup</span><span class="p">:</span> <span class="kt">EventLoopGroup</span><span class="p">,</span>
        <span class="nv">accessKeyId</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
        <span class="nv">secretAccessKey</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span>
        <span class="nv">sessionToken</span><span class="p">:</span> <span class="kt">String</span><span class="p">?,</span>
        <span class="nv">region</span><span class="p">:</span> <span class="kt">Region</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">dynamoDB</span> <span class="o">=</span> <span class="kt">DynamoDB</span><span class="p">(</span>
            <span class="nv">accessKeyId</span><span class="p">:</span> <span class="n">accessKeyId</span><span class="p">,</span>
            <span class="nv">secretAccessKey</span><span class="p">:</span> <span class="n">secretAccessKey</span><span class="p">,</span>
            <span class="nv">sessionToken</span><span class="p">:</span> <span class="n">sessionToken</span><span class="p">,</span>
            <span class="nv">region</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
            <span class="nv">eventLoopGroupProvider</span><span class="p">:</span> <span class="o">.</span><span class="nf">shared</span><span class="p">(</span><span class="n">eventLoopGroup</span><span class="p">))</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getTodos</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="p">[</span><span class="kt">TodoModel</span><span class="p">]</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="kt">TodoModel</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span><span class="o">.</span><span class="nf">all</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getTodo</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">TodoModel</span><span class="p">?</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="kt">TodoModel</span><span class="o">.</span><span class="nf">find</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">id</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">getTodo</span><span class="p">(</span><span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">TodoModel</span><span class="p">?</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="kt">TodoModel</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">filter</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">title</span> <span class="o">==</span> <span class="n">title</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">first</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">patchTodo</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">,</span> <span class="nv">patch</span><span class="p">:</span> <span class="kt">PatchTodo</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">TodoModel</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="k">var</span> <span class="nv">query</span> <span class="o">=</span> <span class="kt">TodoModel</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">filter</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">id</span> <span class="o">==</span> <span class="n">id</span><span class="p">)</span>

        <span class="n">patch</span><span class="o">.</span><span class="nf">patchQuery</span><span class="p">(</span><span class="nv">query</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">query</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">query</span>
            <span class="o">.</span><span class="nf">setAction</span><span class="p">(</span><span class="nv">action</span><span class="p">:</span> <span class="o">.</span><span class="n">update</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">first</span><span class="p">()</span>
            <span class="o">.</span><span class="n">map</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">!</span> <span class="p">}</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">saveTodo</span><span class="p">(</span><span class="nv">todo</span><span class="p">:</span> <span class="kt">TodoModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">TodoModel</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="n">todo</span><span class="o">.</span><span class="nf">save</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">deleteTodo</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">EventLoopFuture</span><span class="o">&lt;</span><span class="kt">Void</span><span class="o">&gt;</span> <span class="p">{</span>
        <span class="kt">TodoModel</span><span class="o">.</span><span class="nf">delete</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">id</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='sort-and-partition-keys' class='heading'>Sort And Partition Keys</h2>

<p>Partition keys and sort keys can be set several ways depending the use case.</p>
<h3 id='set-globally-on-the-schema' class='heading'>Set globally on the schema.</h3>
<pre class="highlight swift"><code>
<span class="kd">final</span> <span class="kd">class</span> <span class="kt">TodoModel</span><span class="p">:</span> <span class="kt">DynamoModel</span> <span class="p">{</span>

    <span class="kd">static</span> <span class="k">var</span> <span class="nv">schema</span><span class="p">:</span> <span class="kt">DynamoSchema</span> <span class="p">{</span>
        <span class="kt">DynamoSchema</span><span class="p">(</span>
            <span class="s">"Todos"</span><span class="p">,</span>
            <span class="nv">partitionKey</span><span class="p">:</span> <span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">key</span><span class="p">:</span> <span class="s">"ListID"</span><span class="p">,</span> <span class="k">default</span><span class="p">:</span> <span class="s">"list"</span><span class="p">),</span>
            <span class="nv">sortKey</span><span class="p">:</span> <span class="kc">nil</span> <span class="c1">// or .init(key: "MySortKey", default: "foo")</span>
        <span class="p">)</span>
    <span class="p">}</span>
    <span class="o">...</span>
<span class="p">}</span>
</code></pre>
<h3 id='set-as-a-field-on-the-model' class='heading'>Set as a field on the model.</h3>

<p>Any field also has flags in the initializer to declare it as a sort or partition key as well as some specialized fields.
The <code><a href="Classes/ID.html">ID</a></code> field for example defaults to being a partition a key.  There is also a <code><a href="Classes/SortKey.html">SortKey</a></code> field.</p>

<p>To change the behavior of an <code><a href="Classes/ID.html">ID</a></code> field it needs to be set at declaration.</p>
<pre class="highlight swift"><code>
<span class="o">...</span>

<span class="kd">@ID(key: "TodoID", type: .sortKey, generatedBy: .user)</span>
<span class="k">var</span> <span class="nv">id</span><span class="p">:</span> <span class="kt">UUID</span>

<span class="o">...</span>
</code></pre>

<p>To declare a sort key just use the <code><a href="Classes/SortKey.html">SortKey</a></code> field.</p>
<pre class="highlight swift"><code><span class="o">...</span>

<span class="kd">@SortKey(key: "MySortKey")</span>
<span class="k">var</span> <span class="nv">sortKey</span><span class="p">:</span> <span class="kt">String</span>

<span class="o">...</span>
</code></pre>

<p>Or declare a standard field as a sort or partition key at declaration.</p>
<pre class="highlight swift"><code><span class="o">...</span>

<span class="kd">@Field(key: "MyPartitionKey", partitionKey: true, sortKey: false)</span>
<span class="k">var</span> <span class="nv">partitionKey</span><span class="p">:</span> <span class="kt">String</span>

<span class="o">...</span>

</code></pre>
<h3 id='set-on-a-query' class='heading'>Set on a query</h3>

<p>You can also specify a sort key or a partition key on a query.  This could potentially override any values that are currently
set on a query.</p>
<pre class="highlight swift"><code>
<span class="kt">TodoModel</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">setSortKey</span><span class="p">(</span><span class="nv">sortKey</span><span class="p">:</span> <span class="s">"Foo"</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="s">"Bar"</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">setPartitionKey</span><span class="p">(</span><span class="nv">partitionKey</span><span class="p">:</span> <span class="s">"Bar"</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="s">"Foo"</span><span class="p">)</span>

<span class="c1">// or if you have a sort key field declared on the model.</span>

<span class="kt">TodoModel</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">setSortKey</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">sortKey</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="s">"Foo"</span><span class="p">)</span>

<span class="c1">// if you declared a field then you would use the `set` method on the query.</span>

<span class="kt">TodoModel</span><span class="o">.</span><span class="nf">query</span><span class="p">(</span><span class="nv">on</span><span class="p">:</span> <span class="n">dynamoDB</span><span class="p">)</span>
    <span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="err">\</span><span class="o">.</span><span class="err">$</span><span class="n">partitionKey</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span> <span class="s">"Partition"</span><span class="p">)</span>

</code></pre>
<h2 id='xctdynamo' class='heading'>XCTDynamo</h2>

<p>A convenience package for testing your models.</p>
<pre class="highlight swift"><code>
<span class="kd">import</span> <span class="kt">XCTest</span>
<span class="kd">import</span> <span class="kt">XCTDynamo</span>
<span class="kd">import</span> <span class="kt">TodoStore</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">TodoStoreTests</span><span class="p">:</span> <span class="kt">XCTestCase</span><span class="p">,</span> <span class="kt">XCTDynamo</span> <span class="p">{</span>

    <span class="k">var</span> <span class="nv">database</span><span class="p">:</span> <span class="kt">DynamoDB</span><span class="o">!</span> <span class="o">=</span> <span class="kt">DynamoDB</span><span class="p">(</span><span class="nv">endpoint</span><span class="p">:</span> <span class="s">"http://localhost:8000"</span><span class="p">)</span>

    <span class="kd">func</span> <span class="nf">testCRUD</span><span class="p">()</span> <span class="k">throws</span> <span class="p">{</span>

        <span class="n">runTest</span> <span class="p">{</span> 
            <span class="k">let</span> <span class="nv">todo</span> <span class="o">=</span> <span class="kt">TodoModel</span><span class="p">(</span>
                <span class="nv">id</span><span class="p">:</span> <span class="o">.</span><span class="nf">init</span><span class="p">(),</span>
                <span class="nv">title</span><span class="p">:</span> <span class="s">"Test"</span><span class="p">,</span> 
                <span class="nv">completed</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
                <span class="nv">order</span><span class="p">:</span> <span class="mi">1</span>
            <span class="p">)</span>

            <span class="k">var</span> <span class="nv">beforeCount</span><span class="p">:</span> <span class="kt">Int</span><span class="o">!</span>

            <span class="k">try</span> <span class="nf">fetchAll</span><span class="p">()</span> <span class="p">{</span> <span class="n">todos</span> <span class="k">in</span> 
                <span class="n">beforeCount</span> <span class="o">=</span> <span class="n">todos</span><span class="o">.</span><span class="n">count</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">save</span><span class="p">(</span><span class="n">todo</span><span class="p">)</span> <span class="p">{</span> <span class="n">saved</span> <span class="k">in</span> 
                <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="n">saved</span><span class="p">,</span> <span class="n">todo</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">find</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">todo</span><span class="o">.</span><span class="n">id</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span> <span class="n">fetched</span> <span class="k">in</span> 
                <span class="kt">XCTAssertNotNil</span><span class="p">(</span><span class="n">fetched</span><span class="p">)</span>
                <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="n">fetched</span><span class="o">!</span><span class="p">,</span> <span class="n">todo</span><span class="p">)</span>
            <span class="p">}</span>
            <span class="o">.</span><span class="nf">fetchAll</span><span class="p">()</span> <span class="p">{</span> <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="nv">$0</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">beforeCount</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">}</span>
            <span class="o">.</span><span class="nf">delete</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="n">todo</span><span class="o">.</span><span class="n">id</span><span class="o">!</span><span class="p">)</span> <span class="p">{</span> <span class="p">}</span>
            <span class="o">.</span><span class="nf">fetchAll</span><span class="p">()</span> <span class="p">{</span> <span class="kt">XCTAssertEqual</span><span class="p">(</span><span class="nv">$0</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="n">beforeCount</span><span class="p">)</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

</code></pre>
<h2 id='status' class='heading'>Status</h2>

<ul>
<li>[x] Supports Static or Dynamic Partition Keys and Sort Keys on Models</li>
<li>[x] Basic equality filters on properties (note that you can not use <code>!=</code> on a partition key or sort key)</li>
<li>[x] Property wrappers for fields, dynamic sort-keys, and id (id can be a partition key or a sort key).</li>
<li>[x] Supports random id generation for <code>UUID</code> (can be overriden to user generated)</li>
<li>[x] Test framework under the <code>XCTDynamo</code> folder (use in your tests by importing the package as a dependency)</li>
<li>[x] Custom encoder and decoder to convert <code>Codable</code> types to types that <code>aws-sdk-swift</code> expects.</li>
<li>[ ] Sorting capabilities.</li>
<li>[ ] More filtering options.</li>
<li>[x] Batch queries and writes.</li>
<li>[x] Paginated queries.</li>
</ul>
<h2 id='contributing' class='heading'>Contributing</h2>

<p>This package is currently under development, if you would like to contribute to <code>SwiftDynamo</code> your help would be appreciated.</p>
<h2 id='credits' class='heading'>Credits</h2>

<p><a href="https://github.com/vapor/vapor.git">vapor/vapor</a></p>

<p><a href="https://github.com/fabianfett/swift-lambda-runtime.git">swift-lambda-runtime</a></p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2020 <a class="link" href="" target="_blank" rel="external">Michael Housh_</a>. All rights reserved. (Last updated: 2020-05-23)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.3</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
